{"version":3,"file":"static/webpack/static/development/pages/index.js.503505908ee5fb2b52bb.hot-update.js","sources":["webpack:///./pages/index.tsx"],"sourcesContent":["import { Icon, Typography } from \"antd\";\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState\n} from \"react\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { useCollection } from \"react-firebase-hooks/firestore\";\nimport styled from \"styled-components\";\nimport { Card } from \"../components/Card\";\nimport { CommendBox } from \"../components/CommendBox\";\nimport { CommentList } from \"../components/CommentList\";\nimport { Header } from \"../components/Header\";\nimport { Image } from \"../components/Image\";\nimport { ResponsiveStackGrid } from \"../components/ResponsiveStackGrid\";\nimport firebase from \"../utils/firebase\";\nimport { Showcase, showcases } from \"../utils/showcases\";\n\nconst { Title, Paragraph } = Typography;\n\nconst StyledCard = styled(Card)`\n  transform: scale(1);\n  transition: transform 1s cubic-bezier(0.075, 0.82, 0.165, 1);\n  &:hover {\n    transform: scale(1.05);\n  }\n`;\n\nconst CardImageLink = styled.a`\n  position: relative;\n  overflow: hidden;\n  .source {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    width: 24px;\n    height: 24px;\n    font-size: 24px;\n    /* background-color: white; */\n  }\n`;\n\nconst Container = styled.div`\n  padding-top: 80px;\n  padding-bottom: 32px;\n`;\n\nconst ShowcaseBody = styled.div`\n  padding: 16px;\n`;\n\nconst SpinnerContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  margin: 8px 0;\n`;\n\nconst StyledTitle = styled(Title)`\n  &.ant-typography {\n    color: #ff577d;\n  }\n`;\n\ninterface IShowcaseCardProps {\n  showcase: Showcase;\n  onSizeChange?: () => any;\n}\n\nconst ShowcaseCard = ({ showcase, onSizeChange }: IShowcaseCardProps) => {\n  const { href, src, title, description } = showcase;\n  const [user, initialising, error] = useAuthState(firebase.auth());\n  const [snapshot, loading] = useCollection(\n    firebase.firestore().collection(`showcase/${showcase.key}/comment`)\n  );\n  const comments = useMemo(() => {\n    return (\n      snapshot && snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))\n    );\n  }, [snapshot]);\n  useEffect(() => {\n    if (onSizeChange) onSizeChange();\n  }, [comments, onSizeChange]);\n  return (\n    <StyledCard>\n      <CardImageLink href={href} target=\"_blank\">\n        <Image src={src} title={title} />\n      </CardImageLink>\n      <ShowcaseBody>\n        <a href={href} target=\"_blank\">\n          <StyledTitle level={4}>{title}</StyledTitle>\n        </a>\n        {description && (\n          <Paragraph type=\"secondary\" ellipsis={{ rows: 4 }}>\n            {description}\n          </Paragraph>\n        )}\n        {loading && (\n          <SpinnerContainer>\n            <Icon\n              type=\"loading\"\n              style={{ fontSize: 32, color: \"#ff577d\" }}\n              spin\n            />\n          </SpinnerContainer>\n        )}\n        {comments && (\n          <CommentList\n            comments={comments}\n            user={user}\n            onDelete={comment => {\n              firebase\n                .firestore()\n                .doc(`showcase/${showcase.key}/comment/${comment.id}`)\n                .delete();\n            }}\n          />\n        )}\n        <CommendBox\n          user={user}\n          showcase={showcase}\n          onSubmit={e => {\n            if (comments) {\n              firebase\n                .firestore()\n                .collection(`showcase/${showcase.key}/comment`)\n                .add({\n                  createdAt: new Date(),\n                  content: e,\n                  uid: user.uid\n                });\n            }\n          }}\n        />\n      </ShowcaseBody>\n    </StyledCard>\n  );\n};\n\nconst Index = () => {\n  const stackGridRef = useRef(null);\n  const onSizeChange = useCallback(\n    () => stackGridRef && stackGridRef.current.updateLayout(),\n    [stackGridRef]\n  );\n  const [appearedShowcases, setAppearedShowcases] = useState([]);\n  useEffect(() => {\n    const showShowcases = async () => {\n      const appeared = [];\n      for (const showcase of showcases) {\n        appeared.push(showcase);\n        setAppearedShowcases([...appeared]);\n        await new Promise(res => setTimeout(() => res(), 600));\n      }\n    };\n    showShowcases();\n  }, []);\n  return (\n    <Container>\n      <Header />\n      <ResponsiveStackGrid gridRef={stackGridRef}>\n        {appearedShowcases.map(showcase => (\n          <ShowcaseCard\n            key={showcase.key}\n            showcase={showcase}\n            onSizeChange={onSizeChange}\n          />\n        ))}\n      </ResponsiveStackGrid>\n    </Container>\n  );\n};\n\nexport default Index;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAEA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAcA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AACA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAKA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AACA;AAIA;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AAHA;AAKA;AACA;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAmBA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAJA;AAAA;AAAA;AACA;AAMA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAAA;AAKA;AAAA;AAAA;AAAA;AACA;AANA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAOA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAUA;AACA;AACA;;;;A","sourceRoot":""}