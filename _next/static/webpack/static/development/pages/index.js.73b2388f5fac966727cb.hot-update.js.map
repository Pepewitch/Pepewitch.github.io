{"version":3,"file":"static/webpack/static/development/pages/index.js.73b2388f5fac966727cb.hot-update.js","sources":["webpack:///./pages/index.tsx"],"sourcesContent":["import { Avatar, Comment, Form, Tooltip, Typography } from \"antd\";\nimport moment from \"moment\";\nimport React, { useCallback, useEffect, useMemo, useRef } from \"react\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { useDocument } from \"react-firebase-hooks/firestore\";\nimport styled from \"styled-components\";\nimport { Card } from \"../components/Card\";\nimport { CommendBox } from \"../components/CommendBox\";\nimport { Header } from \"../components/Header\";\nimport { Image } from \"../components/Image\";\nimport { ResponsiveStackGrid } from \"../components/ResponsiveStackGrid\";\nimport firebase from \"../utils/firebase\";\nimport { Showcase, showcases } from \"../utils/showcases\";\n\nconst { Title, Paragraph } = Typography;\n\nconst Container = styled.div`\n  padding-top: 80px;\n  padding-bottom: 32px;\n`;\n\nconst ShowcaseBody = styled.div`\n  padding: 16px;\n`;\n\ninterface IShowcaseCardProps {\n  showcase: Showcase;\n  onSizeChange: () => any;\n}\n\nconst ShowcaseCard = ({ showcase, onSizeChange }: IShowcaseCardProps) => {\n  const { href, src, title, description } = showcase;\n  const [user, initialising, error] = useAuthState(firebase.auth());\n  const [snapshot, loading] = useDocument(\n    firebase.firestore().doc(`showcase/${showcase.key}`)\n  );\n  const comments = useMemo(() => {\n    if (snapshot) return snapshot.data().comments;\n    return undefined;\n  }, [snapshot]);\n  useEffect(() => {\n    onSizeChange();\n  }, [snapshot, onSizeChange]);\n  return (\n    <Card>\n      <a href={href} target=\"_blank\">\n        <Image src={src} title={title} />\n      </a>\n      <ShowcaseBody>\n        <a href={href} target=\"_blank\">\n          <Title level={4}>{title}</Title>\n        </a>\n        {description && (\n          <Paragraph type=\"secondary\" ellipsis={{ rows: 4 }}>\n            {description}\n          </Paragraph>\n        )}\n        {comments &&\n          comments.map(comment => (\n            <Comment\n              // actions={actions}\n              author={user ? user.displayName : \"Someone\"}\n              avatar={\n                <Avatar\n                  size=\"small\"\n                  icon={!user || comment.uid !== user.uid ? \"user\" : undefined}\n                  src={\n                    user && comment.uid === user.uid ? user.photoURL : undefined\n                  }\n                />\n              }\n              content={<p>{comment.content}</p>}\n              datetime={\n                <Tooltip\n                  title={moment(comment.createdAt.toDate()).format(\n                    \"YYYY-MM-DD HH:mm:ss\"\n                  )}\n                >\n                  <span>{moment(comment.createdAt.toDate()).fromNow()}</span>\n                </Tooltip>\n              }\n            />\n          ))}\n        <CommendBox\n          user={user}\n          showcase={showcase}\n          onSubmit={e => {\n            if (comments) {\n              firebase\n                .firestore()\n                .doc(`showcase/${showcase.key}`)\n                .update({\n                  comment: [\n                    ...comments,\n                    { createdAt: new Date(), content: e, uid: user.uid }\n                  ]\n                });\n            }\n          }}\n        />\n      </ShowcaseBody>\n    </Card>\n  );\n};\n\nconst Index = () => {\n  const stackGridRef = useRef(null);\n  const onSizeChange = useCallback(\n    () => stackGridRef && console.log(stackGridRef.current),\n    [stackGridRef]\n  );\n  return (\n    <Container>\n      <Header />\n      <ResponsiveStackGrid ref={stackGridRef}>\n        {showcases.map((showcase, index) => (\n          <ShowcaseCard\n            key={showcase.key}\n            showcase={showcase}\n            onSizeChange={onSizeChange}\n          />\n        ))}\n      </ResponsiveStackGrid>\n    </Container>\n  );\n};\n\nexport default Index;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAEA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AACA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAnBA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AA0BA;AACA;AACA;AACA;AACA;AAIA;AAEA;AAAA;AAAA;AAAA;AAHA;AAMA;AACA;AAfA;AAAA;AAAA;AAAA;AAAA;AAAA;AAoBA;AACA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAUA;AACA;AACA;;;;A","sourceRoot":""}